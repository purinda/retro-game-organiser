# System name mappings for retro gaming handhelds
# Maps shorthand system names to their full descriptive names

SYSTEMS = {
    "3do": "Panasonic 3DO Interactive Multiplayer",
    "abuse": "Abuse (port)",
    "adam": "Coleco Adam",
    "advision": "Magnavox Odyssey² / Philips Videopac+",
    "amiga500": "Commodore Amiga 500",
    "amiga1200": "Commodore Amiga 1200",
    "amigacd32": "Commodore Amiga CD32",
    "amigacdtv": "Commodore Amiga CDTV",
    "amstradcpc": "Amstrad CPC",
    "apfm1000": "APF Imagination Machine (APF-M1000)",
    "apple2": "Apple II",
    "apple2gs": "Apple IIGS",
    "arcade": "Arcade (various)",
    "arcadia": "Arcadia 2001",
    "archimedes": "Acorn Archimedes",
    "arduboy": "Arduboy",
    "astrocde": "Bally Astrocade",
    "atari800": "Atari 8-bit (400/800/XL/XE)",
    "atari2600": "Atari 2600",
    "atari5200": "Atari 5200",
    "atari7800": "Atari 7800",
    "atarist": "Atari ST",
    "atom": "Acorn Atom",
    "atomiswave": "Sammy Atomiswave (arcade)",
    "bbc": "Acorn BBC Micro",
    "c20": "Commodore VIC-20",
    "c64": "Commodore 64",
    "c128": "Commodore 128",
    "camplynx": "Camputers Lynx",
    "cannonball": "Cannonball (OutRun engine/port)",
    "cavestory": "Cave Story (port)",
    "cdi": "Philips CD-i",
    "cdogs": "C-Dogs (port)",
    "cgenius": "Commander Genius (Apogee games port)",
    "channelf": "Fairchild Channel F",
    "coco": "Tandy/RadioShack TRS-80 Color Computer",
    "colecovision": "ColecoVision",
    "commanderx16": "Commander X16",
    "corsixth": "Corsix's Mod (Theme Hospital port)",
    "cplus4": "Commodore Plus/4",
    "cps1": "Capcom CPS-1 (arcade)",
    "cps2": "Capcom CPS-2 (arcade)",
    "cps3": "Capcom CPS-3 (arcade)",
    "crvision": "CreatiVision",
    "daphne": "Daphne (laserdisc arcade)",
    "devilutionx": "DevilutionX (Diablo port)",
    "dos": "MS-DOS/PC (various ports)",
    "dreamcast": "Sega Dreamcast",
    "easyrpg": "EasyRPG (RPG Maker 2000/2003)",
    "ecwolf": "ECWolf (Wolfenstein 3D port)",
    "eduke32": "EDuke32 (Duke Nukem 3D port)",
    "electron": "Acorn Electron",
    "emulators": "(meta/folder)",
    "fallout1-ce": "Fallout 1 Community Edition (port)",
    "fallout2-ce": "Fallout 2 Community Edition (port)",
    "fbneo": "FinalBurn Neo (arcade)",
    "fds": "Nintendo Famicom Disk System",
    "flash": "Adobe Flash (via Ruffle/etc.)",
    "fm7": "Fujitsu FM-7",
    "fmtowns": "Fujitsu FM Towns",
    "fury": "Fury of the Furries (port)",
    "gamate": "Bit Corporation Gamate",
    "gameandwatch": "Nintendo Game & Watch",
    "gamecom": "Tiger Game.com",
    "gamegear": "Sega Game Gear",
    "gamepock": "Epoch Game Pocket Computer",
    "gb": "Nintendo Game Boy",
    "gb2players": "Game Boy (link/2-player)",
    "gba": "Nintendo Game Boy Advance",
    "gbc": "Nintendo Game Boy Color",
    "gbc2players": "Game Boy Color (link/2-player)",
    "genesis": "Sega Genesis/Mega Drive",
    "gmaster": "Hartung Game Master",
    "gp32": "GamePark 32",
    "gx4000": "Amstrad GX4000",
    "gzdoom": "GZDoom (Doom port)",
    "hcl": "Hover: Combat Racing (port or similar)",
    "hurrican": "Hurrican (port)",
    "intellivision": "Mattel Intellivision",
    "iortcw": "iortcw (Return to Castle Wolfenstein port)",
    "jaguar": "Atari Jaguar",
    "jaguarcd": "Atari Jaguar CD",
    "laser310": "Video Technology Laser 310",
    "lcdgames": "Handheld LCD games",
    "lowresnx": "LowRes NX (fantasy console)",
    "lutro": "Lutro (LÖVE framework)",
    "lynx": "Atari Lynx",
    "macintosh": "Apple Macintosh (early)",
    "mame": "MAME (arcade)",
    "mastersystem": "Sega Master System",
    "megadrive": "Sega Mega Drive (Genesis)",
    "megadrivejp": "Sega Mega Drive (Japan)",
    "megaduck": "Mega Duck",
    "moonlight": "Moonlight (GameStream client)",
    "mpv": "mpv (media player)",
    "mrboom": "Mr. Boom (Bomberman clone)",
    "msu-md": "MSU-1 Mega Drive enhancement",
    "msx1": "MSX1",
    "msx2": "MSX2",
    "msx2+": "MSX2+",
    "msxturbor": "MSX Turbo R",
    "multivision": "Mitsubishi MultiVision",
    "n64": "Nintendo 64",
    "n64dd": "Nintendo 64DD",
    "naomi": "Sega NAOMI (arcade)",
    "naomi2": "Sega NAOMI 2 (arcade)",
    "nds": "Nintendo DS",
    "neogeo": "SNK Neo Geo AES/MVS",
    "neogeocd": "SNK Neo Geo CD",
    "nes": "Nintendo Entertainment System",
    "ngp": "SNK Neo Geo Pocket",
    "ngpc": "SNK Neo Geo Pocket Color",
    "o2em": "Magnavox Odyssey²",
    "odcommander": "OpenDingux Commander (file manager?)",
    "openbor": "OpenBOR (Beat 'em Up engine)",
    "openjazz": "OpenJazz (Jazz Jackrabbit port)",
    "pc88": "NEC PC-88",
    "pc98": "NEC PC-98",
    "pcengine": "NEC PC Engine / TurboGrafx-16",
    "pcenginecd": "NEC PC Engine CD / TurboGrafx-CD",
    "pdp1": "DEC PDP-1",
    "pet": "Commodore PET",
    "pico": "Sega Pico",
    "pico8": "PICO-8 (fantasy console)",
    "plugnplay": "Plug & Play TV games",
    "pokemini": "Pokémon Mini",
    "ports": "Various game ports",
    "prboom": "prBoom (Doom port)",
    "psp": "Sony PlayStation Portable",
    "psx": "Sony PlayStation",
    "ps1": "Sony PlayStation",  # Alias for psx
    "pv1000": "Casio PV-1000",
    "pygame": "PyGame games",
    "quake3": "Quake III Arena (port)",
    "raze": "Raze (Build engine port)",
    "reminiscence": "Reminiscence (Flashback port)",
    "rott": "Rise of the Triad (port)",
    "samcoupe": "SAM Coupé",
    "satellaview": "Nintendo Satellaview (BS-X)",
    "saturn": "Sega Saturn",
    "scummvm": "ScummVM (adventure games)",
    "scv": "Epoch Super Cassette Vision",
    "sdlpop": "SDLPoP (Prince of Persia port)",
    "sega32x": "Sega 32X",
    "segacd": "Sega CD",
    "sfc": "Super Famicom (SNES Japan)",
    "sg1000": "Sega SG-1000",
    "sgb": "Super Game Boy",
    "singe": "Singe (Daphne laserdisc alternative)",
    "snes": "Super Nintendo Entertainment System",
    "snes-msu1": "SNES with MSU-1 enhancement",
    "socrates": "VTech Socrates",
    "solarus": "Solarus (Zelda-like engine)",
    "sonicretro": "Sonic Retro ports/mods",
    "spectravideo": "Spectravideo",
    "sufami": "Bandai Sufami Turbo",
    "superbroswar": "Super Bros War (port)",
    "supergrafx": "NEC SuperGrafx",
    "supervision": "Supervision handheld",
    "supracan": "Super A'Can",
    "systemsp": "(likely Systems+ or placeholder)",
    "tg16": "NEC TurboGrafx-16",
    "tg16cd": "TurboGrafx-CD",
    "thextech": "TheXTech (platformer engine)",
    "thomson": "Thomson computers (MO/TO series)",
    "ti99": "Texas Instruments TI-99/4A",
    "tic80": "TIC-80 (fantasy console)",
    "tools": "(meta/folder)",
    "tutor": "Luxor ABC Tutor",
    "tyrian": "Tyrian (port)",
    "tyrquake": "TyrQuake (Quake port)",
    "uzebox": "Uzebox",
    "vc4000": "Interton VC 4000",
    "vectrex": "GCE Vectrex",
    "vgmplay": "VGMPlay (chiptune player)",
    "videopacplus": "Philips Videopac+ (Odyssey² variant)",
    "virtualboy": "Nintendo Virtual Boy",
    "vis": "(likely Visual 6502 or similar niche)",
    "vitaquake2": "VitaQuake2 (Quake II port)",
    "vsmile": "VTech V.Smile",
    "wswan": "Bandai WonderSwan",
    "wswanc": "WonderSwan Color",
    "x1": "Sharp X1",
    "x68000": "Sharp X68000",
    "xash3d_fwgs": "Xash3D FWGS (Half-Life engine)",
    "xegs": "Atari XEGS",
    "xrick": "xrick (Rick Dangerous port)",
    "zc210": "(possibly niche or typo; unclear)",
    "zx81": "Sinclair ZX81",
    "zxspectrum": "Sinclair ZX Spectrum",
    # Uppercase variants (some ROM sets use these)
    "ARCADE": "Arcade (various)",
    "ATARI2600": "Atari 2600",
    "ATARI7800": "Atari 7800",
    "CPS1": "Capcom CPS-1 (arcade)",
    "CPS2": "Capcom CPS-2 (arcade)",
    "CPS3": "Capcom CPS-3 (arcade)",
    "DC": "Sega Dreamcast",
    "EASYRPG": "EasyRPG (RPG Maker 2000/2003)",
    "FBNEO": "FinalBurn Neo (arcade)",
    "FC": "Nintendo Famicom / NES",
    "FFMPEG": "FFmpeg (media player/tool)",
    "GB": "Nintendo Game Boy",
    "GBA": "Nintendo Game Boy Advance",
    "GBC": "Nintendo Game Boy Color",
    "GG": "Sega Game Gear",
    "GW": "Nintendo Game & Watch",
    "LYNX": "Atari Lynx",
    "MAME": "MAME (arcade)",
    "MAME2003PLUS": "MAME 2003 Plus (arcade)",
    "MAME2010": "MAME 2010 (arcade)",
    "MD": "Sega Mega Drive / Genesis",
    "MS": "Sega Master System",
    "N64": "Nintendo 64",
    "NDS": "Nintendo DS",
    "NEOGEO": "SNK Neo Geo AES/MVS",
    "NGP": "SNK Neo Geo Pocket",
    "OPENBOR": "OpenBOR (Beat 'em Up engine)",
    "PCE": "NEC PC Engine / TurboGrafx-16",
    "PGM": "PolyGame Master (arcade)",
    "PICO8": "PICO-8 (fantasy console)",
    "PS": "Sony PlayStation",
    "PSP": "Sony PlayStation Portable",
    "SFC": "Super Famicom (SNES Japan)",
    "SS": "Sega Saturn",
    "WS": "Bandai WonderSwan",
}


def normalize_system_key(key: str) -> str:
    """
    Normalize a system key to lowercase for consistent lookups.
    
    Args:
        key: The system key (e.g., 'PSP', 'psp', 'Psp')
        
    Returns:
        Lowercase system key
    """
    return key.lower()


def get_system_info(system_key: str) -> tuple[str, str] | None:
    """
    Get system information for a given key.

    Matching priority:
    1. Exact match
    2. Case-insensitive exact match
    3. Contains match (e.g., "Nintendo - N64" contains "n64")

    Args:
        system_key: The system folder name (e.g., 'psp', 'PSP', 'Nintendo - N64')

    Returns:
        Tuple of (shorthand, full_name) or None if not found
    """
    # First try exact match
    if system_key in SYSTEMS:
        return (system_key, SYSTEMS[system_key])

    # Try case-insensitive exact match
    lower_key = normalize_system_key(system_key)
    for key, value in SYSTEMS.items():
        if normalize_system_key(key) == lower_key:
            return (key, value)

    # Try contains match - check if directory name contains any known system key
    # Sort by key length descending to match longer keys first (e.g., "mastersystem" before "master")
    sorted_keys = sorted(SYSTEMS.keys(), key=len, reverse=True)

    # Normalize: remove spaces and special chars for comparison
    normalized_input = lower_key.replace(" ", "").replace("-", "").replace("_", "")

    for key in sorted_keys:
        # Skip very short keys (1-2 chars) to avoid false matches
        if len(key) <= 2:
            continue
        key_lower = key.lower()
        # Check both: key in original, and key in normalized (spaces removed)
        if key_lower in lower_key or key_lower in normalized_input:
            return (key, SYSTEMS[key])

    return None


def get_output_folder_name(system_key: str) -> str:
    """
    Get the output folder name for a system.
    
    Format: "SHORTHAND-Full Name" (e.g., "PSP-Sony PlayStation Portable")
    
    Args:
        system_key: The system folder name from source
        
    Returns:
        Formatted output folder name, or original key if not found
    """
    info = get_system_info(system_key)
    if info:
        shorthand, full_name = info
        return f"{shorthand}-{full_name}"
    
    # Return original key if not in mapping
    return system_key


def is_known_system(system_key: str) -> bool:
    """
    Check if a system key is in our known systems list.
    
    Args:
        system_key: The system folder name
        
    Returns:
        True if known, False otherwise
    """
    return get_system_info(system_key) is not None
